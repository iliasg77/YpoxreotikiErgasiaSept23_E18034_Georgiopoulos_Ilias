# YpoxreotikiErgasiaSept23_E18034_Georgiopoulos_Ilias
(Το web service έχει υλοποιηθεί σε λειτουργικό windows)
Στο mongodb_dockerfile είναι αποθηκευμένο το dockerfile που θα χρειαστεί για να δημιουργήσουμε το image για τη βάση δεδομένων mongodb.
Στο web-service_dockerfile είναι αποθηκευμένο το dockerfile που θα χρειαστεί για να δημιουργήσουμε το image για το web service.
Στο app.py αρχείο βρίσκεται ο κώδικας που εμπεριέχει τις λειτουργικότητες του web service.
Το docker-compose.yml είναι αποθηκευμένος ο κώδικας που επιτρέπει την επικοινωνία μεταξύ της βάσης δεδομένων που έχουμε δημιουργήσει και του web service.

Τώρα, όσον αφορά τις λειτουργικότητες του συστήματος που παρέχονται στο "app.py" αρχείο:
Αρχικά έχουν γίνει import τα κατάλληλα framework και βιβλιοθήκες της python, τα οποία θα χρειαστούν για την υλοποίηση του web service.Στη συνέχεια γίνεται η σύνδεσημε τη mongodb και βλέπουμε τις μεταβλητές που αντιστοιχούν στη βάση δεδομένων της mongodb και στα αντίστοιχα collections της βάσης δεδομένων (*Για να εκτελεστεί η εφαρμογή πρέπει να δημιουργηθεί στη mongodb μία βάση δεδομένων με collections με τα αντίστοιχα ονόματα που φαίνονται στο κώδικα).Έπειτα βλέπουμε στο κώδικα τη συνάρτηση is_user_logged_in(), όπου ελέγχει αν ο χρήστης είναι συνδεδεμένος. Στη συνέχεια οι επόμενες δύο συναρτήσεις is_user, is_admin ελέγχουν αν ο χρήστης που έχει συνδεθεί είναι απλός χρήστης ή διαχειριστής. (*Σημείωση στα collections Users, Admin της βάσης δεδομένων αποθηκεύονται οι πληροφορίες για τους χρήστες). 'Επειτα στο login():
ορίζονται τα πεδία username και password που πρέπει να δώσει ο χρήστης για να κάνει login στο σύστημα(*@app.route("/login", methods=["POST"]), μας δίχνει τη διαδρομή που θα ακολουθήσουμε στο postman για να εκτελέσουμε τη συγκεκριμένη λειτουργικότητα, η οποία θα είναι IPlocalhost/login).Έπειτα η επόμενη λειτουργικότητα register() αφορά την εγγραφή του χρήστη στο σύστημα η οποία αποθηκεύει τα αντίστοιχα πεδία στο collection register για username του χρήστη θα αποθηκεύεται το email του όπως συμβαίνει στα περισσότερα συστήματα μιας και το email είναι μοναδικό για κάθε χρήστη.Η επόμενη λειτουργικότητα delete_account() αφορά τη διαγραφή από το collection ενός απλού χρήστη με βάση το username που έδωσε, όταν έκανε είσοδο στο σύτημα. Στη συνέχεια η search_books() εκτελεί αναζήτηση για τα βιλία που ψάχνει ο χρήστης με βάση τον τίτλο, τον συγγραφέα και το ISBN του βιβλίου (*Στο τίτλο και το συγγραφέα έχουν προστεθεί τα {"$regex": title, "$options": "i"} και {"$regex": author, "$options": "i"} τα οποία αν για παράδειγμα ο χρήστης δώσει το string "Hello" και στα collections είναι αποθηκευμένο ως "HELLO" αυτές οι εντολές θα το αντιστοιχίσουν). Έπειτα η reserve_book κάνει κράτηση ενός βιλίου με βάση το ISBN και εφόσον δεν υπάρχει στο collection Reservations. Η check_book_availability ελέγχει αν υπάρχει διαθεσιμότητα στο βιβλίο και εφόσον υπάρχει επιστρέφεται μήνυμα ότι είναι διαθέσιμο, οι μέρες που μπορεί να δανεισθεί και η περιληψή του. 'Επειτα η user_reservations εμφανίζει για τον χρήστη που έχει κάνει σύνδεση, όλες τις κρατήσεις που έχει πραγματοποιήσει.Η add_book αφορά τον χρήστη που είναι συνδεδεμένος ως admin στο σύστημα και του παρέχει τη λειτουργικότητα για εισαγωγή στο collection BooksAvailable ένός νέου βιβλίου με τα αντίστοιχα πεδία. Η admin_search_books_advanced έχει την ίδια λειτουργικότητα με την search_books , αλλά αφορά τον διαχειριστή και έχει παραπάνω πεδία με τα οποία μπορεί να γίνει η αναζήτηση. Στη συνέχεια η dmin_update_borrowing_days δίνει τη δυνατότητα στον admin να κάνει update το πεδίο borrowingDays στο collection BooksAvailable με βάση το ISBN που θα δώσει. H admin_delete_book δίνει τη δυνατότητα στο διαχειριστή να διαγράψει ένα ήδη υπάρχον βιβλίο με βάση το ISBN που θα δώσει. Τέλος η admin_view_book_details(isbn) δίνει τη δυνατότητα στο διαχειριστή να δει όλα τα αντίστοιχα πεδία για ένα βιβλίο που είναι αποθηκευμένο στο collection BooksAvailable.



Τώρα εφόσον έχουμε υλοποιήσει το κώδικα python και τη βάση mongodb θα πρέπει να δημιουργηθεί ένα docker image για το web service και ένα για τη mongodb. Αρχικά για το docker image του web service, ανοίγουμε ένα τερματικό "πατάμε" τη διαδρομή που βρίσκεται το αντίστοιχο dockerfile, στη συνέχεια γράφουμε την εντολή docker build -t my-flask-app . Έτσι δημιουργείται ένα docker image με όνομα my-flask-app. Κάνουμε το αντίστοιχο για το docker image της mongodb όμως τώρα θα γράψουμε την εντολή docker build -t my-mongodb-image .
Έτσιθα δημιουργηθεί ένα docker image για τη mongodb με όνομα my-mongodb-image. Εφόσον τα δημιουργήσουμε πατάμε την εντολή docker-compose up για να αλληλεπιδρούν τα container μεταξύ τους. Ανοίγουμε το docker desktop και πατάμε "run" στο my-flask-app χρησιμοποιούμε την ip που τρέχει το web service στο postman μαζί με το route της κάθε λειτουργικότητας για να κάνουμε αιτήματα http αιτήματα στο web service
